2025-09-23 18:43:54,642 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:43:54,643 - config - WARNING - API key not found
2025-09-23 18:43:54,643 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:43:54,643 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:44:27,261 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:44:27,261 - config - WARNING - API key not found
2025-09-23 18:44:27,262 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:44:27,262 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:44:41,420 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:44:41,421 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:44:41,421 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:44:41,763 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:41,771 - ai_extraction - INFO - Waiting 5 seconds before retry...
2025-09-23 18:44:46,772 - ai_extraction - INFO - Retry attempt 2/3
2025-09-23 18:44:46,786 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:46,787 - ai_extraction - INFO - Waiting 10 seconds before retry...
2025-09-23 18:44:56,788 - ai_extraction - INFO - Retry attempt 3/3
2025-09-23 18:44:56,800 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:56,801 - ai_extraction - ERROR - Data extraction failed after 3 attempts
2025-09-23 18:44:56,802 - ai_extraction - INFO - Creating fallback extraction result
2025-09-23 18:45:52,756 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:45:52,756 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2893 chars)
2025-09-23 18:45:52,756 - ai_extraction - INFO - Received response from GPT (length: 264 chars)
2025-09-23 18:46:11,378 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:11,378 - config - WARNING - API key not found
2025-09-23 18:46:11,379 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:46:11,379 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:46:11,380 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:11,381 - config - WARNING - API key not found
2025-09-23 18:46:11,381 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:46:11,381 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:46:29,531 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:29,532 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:46:29,532 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:46:29,832 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:29,832 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 3508 chars)
2025-09-23 18:46:29,832 - ai_extraction - INFO - Received response from GPT (length: 222 chars)
2025-09-23 18:46:29,833 - ai_extraction - INFO - GPT extraction completed
2025-09-23 18:46:29,833 - ai_extraction - INFO - Validating extraction result for sample_document.pdf
2025-09-23 18:46:29,833 - ai_extraction - WARNING - Missing financial fields filled with defaults
2025-09-23 18:46:29,833 - ai_extraction - WARNING - Error validating financial calculations: 'bad_debt'
2025-09-23 18:46:29,833 - ai_extraction - INFO - Data extraction successful
2025-09-23 18:46:29,835 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:29,835 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:46:29,835 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:46:29,844 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:29,845 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2893 chars)
2025-09-23 18:46:29,845 - ai_extraction - INFO - Received response from GPT (length: 264 chars)
2025-09-23 18:46:29,845 - ai_extraction - INFO - GPT extraction completed
2025-09-23 18:46:29,846 - ai_extraction - INFO - Validating extraction result for sample_financial_statement.txt
2025-09-23 18:46:29,846 - ai_extraction - WARNING - Missing financial fields filled with defaults
2025-09-23 18:46:29,846 - ai_extraction - WARNING - Error validating financial calculations: 'bad_debt'
2025-09-23 18:46:29,846 - ai_extraction - INFO - Data extraction successful
2025-09-23 18:46:52,406 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:52,406 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 3508 chars)
2025-09-23 18:46:52,407 - ai_extraction - INFO - Received response from GPT (length: 45 chars)
2025-09-23 18:46:52,417 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:52,417 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2961 chars)
2025-09-23 18:46:52,418 - ai_extraction - INFO - Received response from GPT (length: 57 chars)
2025-09-23 19:05:44,255 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:05:44,255 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:05:44,256 - config - WARNING - API key not found
2025-09-23 19:05:51,928 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:05:51,946 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:05:58,338 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:17:06,143 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:17:06,143 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:17:06,144 - config - WARNING - API key not found
2025-09-23 19:17:13,066 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:17:13,070 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:17:19,445 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:21:45,867 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:21:45,868 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:21:45,868 - config - WARNING - API key not found
2025-09-23 19:21:52,864 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:21:52,869 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:21:59,260 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-24 16:41:59,770 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 16:41:59,771 - ai_extraction - INFO - Processing as Excel file
2025-09-24 16:41:59,781 - ai_extraction - INFO - Extracted text content length: 2025 chars
2025-09-24 16:41:59,781 - ai_extraction - INFO - Extracted text content length: 2025 chars
2025-09-24 16:41:59,781 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5875 chars)
2025-09-24 16:41:59,781 - ai_extraction - INFO - Received response from GPT (length: 682 chars)
2025-09-24 16:41:59,781 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5875 chars)
2025-09-24 16:41:59,782 - ai_extraction - INFO - Successfully parsed JSON from GPT response
s)
2025-09-24 16:41:59,782 - ai_extraction - INFO - Successfully parsed JSON from GPT response
ype', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 16:41:59,782 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 16:53:42,575 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 16:53:42,575 - ai_extraction - INFO - Processing as Excel file
2025-09-24 16:53:42,583 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 16:53:42,584 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5774 chars)
2025-09-24 16:53:42,584 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 16:53:42,584 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 16:53:42,584 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 16:53:42,584 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 16:53:42,585 - ai_extraction - INFO - Processing as CSV file
2025-09-24 16:53:42,586 - ai_extraction - INFO - Extracted text content length: 607 chars
2025-09-24 16:53:42,586 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4842 chars)
2025-09-24 16:53:42,587 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 16:53:42,587 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 16:53:42,587 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 16:53:42,587 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 16:53:42,588 - ai_extraction - INFO - Processing as text file
2025-09-24 16:53:42,588 - ai_extraction - INFO - Extracted text content length: 605 chars
2025-09-24 16:53:42,588 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4840 chars)
2025-09-24 16:53:42,588 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 16:53:42,588 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 16:53:42,588 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:00:16,527 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:00:16,528 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:00:16,536 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 17:00:16,537 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5774 chars)
2025-09-24 17:00:16,538 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:00:16,538 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:00:16,538 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:00:16,538 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 17:00:16,538 - ai_extraction - INFO - Processing as CSV file
2025-09-24 17:00:16,540 - ai_extraction - INFO - Extracted text content length: 607 chars
2025-09-24 17:00:16,540 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4842 chars)
2025-09-24 17:00:16,541 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:00:16,541 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:00:16,541 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:00:16,541 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 17:00:16,542 - ai_extraction - INFO - Processing as text file
2025-09-24 17:00:16,542 - ai_extraction - INFO - Extracted text content length: 605 chars
2025-09-24 17:00:16,542 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4840 chars)
2025-09-24 17:00:16,543 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:00:16,543 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:00:16,543 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:02:28,654 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:02:28,655 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:02:28,665 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 17:02:28,665 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5774 chars)
2025-09-24 17:02:28,665 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:02:28,665 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:02:28,666 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:02:28,666 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 17:02:28,666 - ai_extraction - INFO - Processing as CSV file
2025-09-24 17:02:28,668 - ai_extraction - INFO - Extracted text content length: 666 chars
2025-09-24 17:02:28,669 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 17:02:28,669 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:02:28,669 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:02:28,669 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:02:28,670 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 17:02:28,670 - ai_extraction - INFO - Processing as text file
2025-09-24 17:02:28,670 - ai_extraction - INFO - Extracted text content length: 956 chars
2025-09-24 17:02:28,670 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5191 chars)
2025-09-24 17:02:28,670 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:02:28,670 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:02:28,670 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:04:20,533 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:04:20,534 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:04:20,542 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 17:04:20,542 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5774 chars)
2025-09-24 17:04:20,543 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:04:20,543 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:04:20,543 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:04:20,543 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 17:04:20,544 - ai_extraction - INFO - Processing as CSV file
2025-09-24 17:04:20,546 - ai_extraction - INFO - Extracted text content length: 666 chars
2025-09-24 17:04:20,546 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 17:04:20,546 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:04:20,546 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:04:20,546 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:04:20,547 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 17:04:20,547 - ai_extraction - INFO - Processing as text file
2025-09-24 17:04:20,547 - ai_extraction - INFO - Extracted text content length: 956 chars
2025-09-24 17:04:20,547 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5191 chars)
2025-09-24 17:04:20,548 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:04:20,548 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:04:20,548 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:06:13,400 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:06:13,400 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:06:13,411 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 17:06:13,411 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5774 chars)
2025-09-24 17:06:13,412 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:06:13,412 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:06:13,412 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:06:13,413 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 17:06:13,413 - ai_extraction - INFO - Processing as CSV file
2025-09-24 17:06:13,415 - ai_extraction - INFO - Extracted text content length: 666 chars
2025-09-24 17:06:13,415 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 17:06:13,415 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:06:13,416 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:06:13,416 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:06:13,416 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 17:06:13,416 - ai_extraction - INFO - Processing as text file
2025-09-24 17:06:13,417 - ai_extraction - INFO - Extracted text content length: 956 chars
2025-09-24 17:06:13,417 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5191 chars)
2025-09-24 17:06:13,417 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:06:13,417 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:06:13,417 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:13:20,779 - ai_extraction - INFO - Extracted 7 financial fields from text response
2025-09-24 17:13:20,780 - ai_extraction - INFO - Extracted 7 financial fields from text response
2025-09-24 17:13:20,780 - ai_extraction - INFO - Extracted 5 financial fields from text response
2025-09-24 17:14:34,425 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:14:34,425 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:14:34,435 - ai_extraction - INFO - Extracted text content length: 1537 chars
2025-09-24 17:14:34,435 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 6364 chars)
2025-09-24 17:14:34,435 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:14:34,435 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:14:34,435 - ai_extraction - INFO - GPT extraction successful with 24 meaningful fields
2025-09-24 17:14:34,435 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:14:34,436 - ai_extraction - INFO - Processing file with extension: csv
2025-09-24 17:14:34,436 - ai_extraction - INFO - Processing as CSV file
2025-09-24 17:14:34,439 - ai_extraction - INFO - Extracted text content length: 666 chars
2025-09-24 17:14:34,439 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5491 chars)
2025-09-24 17:14:34,439 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:14:34,439 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:14:34,439 - ai_extraction - INFO - GPT extraction successful with 24 meaningful fields
2025-09-24 17:14:34,440 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:14:34,440 - ai_extraction - INFO - Processing file with extension: txt
2025-09-24 17:14:34,440 - ai_extraction - INFO - Processing as text file
2025-09-24 17:14:34,440 - ai_extraction - INFO - Extracted text content length: 956 chars
2025-09-24 17:14:34,440 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5781 chars)
2025-09-24 17:14:34,440 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:14:34,441 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:14:34,441 - ai_extraction - INFO - GPT extraction successful with 24 meaningful fields
2025-09-24 17:14:34,441 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 17:39:12,892 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 17:39:12,893 - ai_extraction - INFO - Processing as Excel file
2025-09-24 17:39:12,903 - ai_extraction - INFO - Extracted text content length: 943 chars
2025-09-24 17:39:12,904 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5788 chars)
2025-09-24 17:39:12,904 - ai_extraction - INFO - Received response from GPT (length: 667 chars)
2025-09-24 17:39:12,904 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 17:39:12,904 - ai_extraction - INFO - GPT extraction successful with required financial fields
2025-09-24 17:39:12,904 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 19:54:23,162 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 19:54:23,162 - ai_extraction - INFO - Processing as Excel file
2025-09-24 19:54:23,162 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 19:54:23,163 - ai_extraction - INFO - Extracted text content length: 145 chars
2025-09-24 19:54:23,163 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 19:54:23,163 - ai_extraction - INFO - Received response from GPT (length: 671 chars)
2025-09-24 19:54:23,163 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,163 - ai_extraction - INFO - GPT extraction successful with required financial fields and meaningful data
2025-09-24 19:54:23,163 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 19:54:23,165 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 19:54:23,165 - ai_extraction - INFO - Processing as Excel file
2025-09-24 19:54:23,165 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 19:54:23,165 - ai_extraction - INFO - Extracted text content length: 145 chars
2025-09-24 19:54:23,165 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 19:54:23,165 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:54:23,166 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,166 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 1/3)
2025-09-24 19:54:23,166 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 19:54:23,166 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:54:23,166 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,166 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 2/3)
2025-09-24 19:54:23,167 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 19:54:23,167 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:54:23,167 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,167 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 3/3)
2025-09-24 19:54:23,167 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 19:54:23,172 - ai_extraction - ERROR - All extraction methods failed, returning fallback result
2025-09-24 19:54:23,173 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 19:54:23,173 - ai_extraction - INFO - Processing as Excel file
2025-09-24 19:54:23,174 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 19:54:23,174 - ai_extraction - INFO - Extracted text content length: 145 chars
2025-09-24 19:54:23,174 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4901 chars)
2025-09-24 19:54:23,174 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 19:54:23,174 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,174 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 1/3)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,175 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 2/3)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 19:54:23,175 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:54:23,176 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 3/3)
2025-09-24 19:54:23,176 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 19:54:23,176 - ai_extraction - ERROR - All extraction methods failed, returning fallback result
2025-09-24 19:54:23,178 - ai_extraction - INFO - Extracted 11 financial fields from text response
2025-09-24 19:55:01,220 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 19:55:01,220 - ai_extraction - INFO - Processing as Excel file
2025-09-24 19:55:01,230 - ai_extraction - INFO - Extracted text content length: 674 chars
2025-09-24 19:55:01,231 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5430 chars)
2025-09-24 19:55:01,231 - ai_extraction - INFO - Received response from GPT (length: 671 chars)
2025-09-24 19:55:01,231 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:55:01,231 - ai_extraction - INFO - GPT extraction successful with required financial fields and meaningful data
2025-09-24 19:55:01,231 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 19:55:01,232 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 19:55:01,232 - ai_extraction - INFO - Processing as Excel file
2025-09-24 19:55:01,240 - ai_extraction - INFO - Extracted text content length: 674 chars
2025-09-24 19:55:01,240 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5430 chars)
2025-09-24 19:55:01,240 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:55:01,241 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:55:01,241 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 1/3)
2025-09-24 19:55:01,241 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 19:55:01,241 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:55:01,242 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:55:01,242 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 2/3)
2025-09-24 19:55:01,242 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 19:55:01,242 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 19:55:01,242 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 19:55:01,242 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 3/3)
2025-09-24 19:55:01,243 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 19:55:01,248 - ai_extraction - INFO - Extracted 16 financial fields from text response
2025-09-24 19:55:01,248 - ai_extraction - INFO - Successfully extracted financial data directly from document text
2025-09-24 20:20:03,820 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 20:20:03,821 - ai_extraction - INFO - Processing as Excel file
2025-09-24 20:20:03,830 - ai_extraction - INFO - Extracted text content length: 674 chars
2025-09-24 20:20:03,830 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5430 chars)
2025-09-24 20:20:03,830 - ai_extraction - INFO - Received response from GPT (length: 671 chars)
2025-09-24 20:20:03,831 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:20:03,831 - ai_extraction - INFO - GPT extraction successful with required financial fields and meaningful data
2025-09-24 20:20:03,831 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 20:20:03,832 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 20:20:03,832 - ai_extraction - INFO - Processing as Excel file
2025-09-24 20:20:03,840 - ai_extraction - INFO - Extracted text content length: 674 chars
2025-09-24 20:20:03,841 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 5430 chars)
2025-09-24 20:20:03,841 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:20:03,841 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:20:03,841 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 1/3)
2025-09-24 20:20:03,841 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 20:20:03,841 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:20:03,842 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:20:03,842 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 2/3)
2025-09-24 20:20:03,842 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 20:20:03,842 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:20:03,842 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:20:03,842 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 3/3)
2025-09-24 20:20:03,842 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 20:20:03,847 - ai_extraction - INFO - Extracted 16 financial fields from text response
2025-09-24 20:20:03,847 - ai_extraction - INFO - Successfully extracted financial data directly from document text
2025-09-24 20:29:04,061 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 20:29:04,061 - ai_extraction - INFO - Processing as Excel file
2025-09-24 20:29:04,062 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 20:29:04,062 - ai_extraction - INFO - Extracted text content length: 189 chars
2025-09-24 20:29:04,062 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4945 chars)
2025-09-24 20:29:04,062 - ai_extraction - INFO - Received response from GPT (length: 671 chars)
2025-09-24 20:29:04,063 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,063 - ai_extraction - INFO - GPT extraction successful with required financial fields and meaningful data
2025-09-24 20:29:04,063 - ai_extraction - INFO - GPT response keys: ['file_name', 'document_type', 'gpr', 'vacancy_loss', 'concessions', 'bad_debt', 'other_income', 'egi', 'opex', 'noi', 'property_taxes', 'insurance', 'repairs_maintenance', 'utilities', 'management_fees', 'parking', 'laundry', 'late_fees', 'pet_fees', 'application_fees', 'storage_fees', 'amenity_fees', 'utility_reimbursements', 'cleaning_fees', 'cancellation_fees', 'miscellaneous']
2025-09-24 20:29:04,064 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 20:29:04,064 - ai_extraction - INFO - Processing as Excel file
2025-09-24 20:29:04,064 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 20:29:04,064 - ai_extraction - INFO - Extracted text content length: 189 chars
2025-09-24 20:29:04,064 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4945 chars)
2025-09-24 20:29:04,064 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:29:04,064 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,065 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 1/3)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,065 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 2/3)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Received response from GPT (length: 601 chars)
2025-09-24 20:29:04,065 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,066 - ai_extraction - WARNING - GPT response has required fields but no meaningful data (attempt 3/3)
2025-09-24 20:29:04,066 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 20:29:04,071 - ai_extraction - ERROR - All extraction methods failed, returning fallback result
2025-09-24 20:29:04,072 - ai_extraction - INFO - Processing file with extension: xlsx
2025-09-24 20:29:04,072 - ai_extraction - INFO - Processing as Excel file
2025-09-24 20:29:04,073 - ai_extraction - WARNING - File processing failed for test_file.xlsx, falling back to text decoding: Excel file format cannot be determined, you must specify an engine manually.
2025-09-24 20:29:04,073 - ai_extraction - INFO - Extracted text content length: 189 chars
2025-09-24 20:29:04,073 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 4945 chars)
2025-09-24 20:29:04,073 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 20:29:04,073 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,073 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 1/3)
2025-09-24 20:29:04,073 - ai_extraction - INFO - Retrying GPT extraction (attempt 2/3)
2025-09-24 20:29:04,074 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 20:29:04,074 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,074 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 2/3)
2025-09-24 20:29:04,074 - ai_extraction - INFO - Retrying GPT extraction (attempt 3/3)
2025-09-24 20:29:04,074 - ai_extraction - INFO - Received response from GPT (length: 124 chars)
2025-09-24 20:29:04,074 - ai_extraction - INFO - Successfully parsed JSON from GPT response
2025-09-24 20:29:04,074 - ai_extraction - WARNING - GPT response missing required financial fields (attempt 3/3)
2025-09-24 20:29:04,074 - ai_extraction - WARNING - All GPT attempts failed, trying direct text extraction
2025-09-24 20:29:04,075 - ai_extraction - ERROR - All extraction methods failed, returning fallback result
2025-09-24 20:29:04,076 - ai_extraction - INFO - Extracted 11 financial fields from text response
2025-09-25 19:13:18,869 - ai_extraction - WARNING - Transposed Excel extraction also failed: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-09-25 19:15:36,796 - ai_extraction - WARNING - Transposed Excel extraction also failed: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-09-25 19:19:09,727 - noianalyzer.ai_extraction - WARNING - Transposed Excel extraction also failed: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-09-25 19:21:37,592 - ai_extraction - WARNING - Transposed Excel extraction also failed: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-09-25 19:33:45,011 - config - WARNING - API key not found
2025-09-26 14:29:33,227 - config - WARNING - API key not found
2025-09-26 14:29:40,471 - config - WARNING - API key not found
2025-09-26 14:30:50,919 - config - WARNING - API key not found
