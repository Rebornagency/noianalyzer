2025-09-23 18:43:54,642 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:43:54,643 - config - WARNING - API key not found
2025-09-23 18:43:54,643 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:43:54,643 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:44:27,261 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:44:27,261 - config - WARNING - API key not found
2025-09-23 18:44:27,262 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:44:27,262 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:44:41,420 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:44:41,421 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:44:41,421 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:44:41,763 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:41,771 - ai_extraction - INFO - Waiting 5 seconds before retry...
2025-09-23 18:44:46,772 - ai_extraction - INFO - Retry attempt 2/3
2025-09-23 18:44:46,786 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:46,787 - ai_extraction - INFO - Waiting 10 seconds before retry...
2025-09-23 18:44:56,788 - ai_extraction - INFO - Retry attempt 3/3
2025-09-23 18:44:56,800 - ai_extraction - ERROR - Unexpected error during GPT extraction: failed to find libmagic.  Check your installation
Traceback (most recent call last):
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 100, in extract_noi_data
    result = extract_financial_data_with_gpt(file_content, file_name, document_type_hint, openai_api_key)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\ai_extraction.py", line 166, in extract_financial_data_with_gpt
    from preprocessing_module import FilePreprocessor
  File "C:\Users\edgar\Documents\GitHub\noianalyzer\noianalyzer\preprocessing_module.py", line 8, in <module>
    import magic
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\__init__.py", line 209, in <module>
    libmagic = loader.load_lib()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\edgar\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\magic\loader.py", line 49, in load_lib
    raise ImportError('failed to find libmagic.  Check your installation')
ImportError: failed to find libmagic.  Check your installation
2025-09-23 18:44:56,801 - ai_extraction - ERROR - Data extraction failed after 3 attempts
2025-09-23 18:44:56,802 - ai_extraction - INFO - Creating fallback extraction result
2025-09-23 18:45:52,756 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:45:52,756 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2893 chars)
2025-09-23 18:45:52,756 - ai_extraction - INFO - Received response from GPT (length: 264 chars)
2025-09-23 18:46:11,378 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:11,378 - config - WARNING - API key not found
2025-09-23 18:46:11,379 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:46:11,379 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:46:11,380 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:11,381 - config - WARNING - API key not found
2025-09-23 18:46:11,381 - ai_extraction - ERROR - OpenAI API key not configured
2025-09-23 18:46:11,381 - ai_extraction - ERROR - NOI Analyzer error in extract_noi_data: OpenAI API key not configured. Please set your OpenAI API key.
2025-09-23 18:46:29,531 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:29,532 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:46:29,532 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:46:29,832 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:29,832 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 3508 chars)
2025-09-23 18:46:29,832 - ai_extraction - INFO - Received response from GPT (length: 222 chars)
2025-09-23 18:46:29,833 - ai_extraction - INFO - GPT extraction completed
2025-09-23 18:46:29,833 - ai_extraction - INFO - Validating extraction result for sample_document.pdf
2025-09-23 18:46:29,833 - ai_extraction - WARNING - Missing financial fields filled with defaults
2025-09-23 18:46:29,833 - ai_extraction - WARNING - Error validating financial calculations: 'bad_debt'
2025-09-23 18:46:29,833 - ai_extraction - INFO - Data extraction successful
2025-09-23 18:46:29,835 - ai_extraction - INFO - Starting GPT-based data extraction
2025-09-23 18:46:29,835 - config - INFO - Using OpenAI API key from environment variable
2025-09-23 18:46:29,835 - ai_extraction - INFO - File prepared for GPT processing
2025-09-23 18:46:29,844 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:29,845 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2893 chars)
2025-09-23 18:46:29,845 - ai_extraction - INFO - Received response from GPT (length: 264 chars)
2025-09-23 18:46:29,845 - ai_extraction - INFO - GPT extraction completed
2025-09-23 18:46:29,846 - ai_extraction - INFO - Validating extraction result for sample_financial_statement.txt
2025-09-23 18:46:29,846 - ai_extraction - WARNING - Missing financial fields filled with defaults
2025-09-23 18:46:29,846 - ai_extraction - WARNING - Error validating financial calculations: 'bad_debt'
2025-09-23 18:46:29,846 - ai_extraction - INFO - Data extraction successful
2025-09-23 18:46:52,406 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:52,406 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 3508 chars)
2025-09-23 18:46:52,407 - ai_extraction - INFO - Received response from GPT (length: 45 chars)
2025-09-23 18:46:52,417 - ai_extraction - WARNING - Preprocessing module not available: failed to find libmagic.  Check your installation
2025-09-23 18:46:52,417 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2961 chars)
2025-09-23 18:46:52,418 - ai_extraction - INFO - Received response from GPT (length: 57 chars)
2025-09-23 19:05:44,255 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:05:44,255 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:05:44,256 - config - WARNING - API key not found
2025-09-23 19:05:51,928 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:05:51,946 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:05:58,338 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:17:06,143 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:17:06,143 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:17:06,144 - config - WARNING - API key not found
2025-09-23 19:17:13,066 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:17:13,070 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:17:19,445 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:21:45,867 - ai_extraction - WARNING - CSV extraction failed, falling back to basic decoding: Cannot convert numpy.ndarray to numpy.ndarray
2025-09-23 19:21:45,868 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2700 chars)
2025-09-23 19:21:45,868 - config - WARNING - API key not found
2025-09-23 19:21:52,864 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
2025-09-23 19:21:52,869 - ai_extraction - INFO - Sending extraction prompt to GPT (length: 2873 chars)
2025-09-23 19:21:59,260 - ai_extraction - ERROR - Error calling OpenAI API: Error code: 401 - {'error': {'message': "You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.", 'type': 'invalid_request_error', 'param': None, 'code': None}}
